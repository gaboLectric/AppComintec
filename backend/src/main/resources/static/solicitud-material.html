<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comintec - Solicitud de Material</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/solicitud-material.css">
</head>
<body>
  <!-- Barra de navegación -->
  <nav class="navbar">
    <div class="container navbar-container">
      <div class="navbar-logo">
        <div class="navbar-logo-img"></div>
        <span>Comintec</span>
      </div>
      
      <div class="nav-menu" id="navMenu">
        <!-- Primera fila de navegación -->
        <div class="nav-menu-row">
          <a href="index.html" class="nav-item">
            <i class="fas fa-tachometer-alt"></i> Panel de Control
          </a>
          
          <div class="nav-dropdown">
            <a href="#" class="nav-item">
              <i class="fas fa-chart-bar"></i> Ventas <i class="fas fa-chevron-down"></i>
            </a>
            <div class="nav-dropdown-menu">
              <a href="#" class="nav-dropdown-item">Agregar Cliente (Ref: 001)</a>
              <a href="#" class="nav-dropdown-item">Mis Clientes (Ref: 002)</a>
              <a href="#" class="nav-dropdown-item">Borrador de Cotización (Ref: 003)</a>
              <a href="#" class="nav-dropdown-item">Existencias de Productos (Ref: 004)</a>
              <a href="#" class="nav-dropdown-item">Asignación de Clientes (Ref: 005)</a>
              <a href="#" class="nav-dropdown-item">Fichas Técnicas (Ref: 006)</a>
            </div>
          </div>
          
          <a href="#" class="nav-item">
            <i class="fas fa-box"></i> Inventario
          </a>
          
          <div class="nav-dropdown">
            <a href="#" class="nav-item active">
              <i class="fas fa-sliders-h"></i> Administración <i class="fas fa-chevron-down"></i>
            </a>
            <div class="nav-dropdown-menu">
              <a href="#" class="nav-dropdown-item">Solicitud de Viáticos (Ref: 007)</a>
              <a href="solicitud-material.html" class="nav-dropdown-item">Solicitud de Material (Ref: 008)</a>
              <a href="#" class="nav-dropdown-item">Solicitud de Tiempo (Ref: 009)</a>
              <a href="#" class="nav-dropdown-item">Solicitud de Paquetería (Ref: 010)</a>
              <a href="#" class="nav-dropdown-item">Asigna Número Fiscal (Ref: 011)</a>
              <a href="#" class="nav-dropdown-item">Mis Solicitudes (Ref: 012)</a>
              <a href="#" class="nav-dropdown-item">Contratos Repse (Ref: 013)</a>
            </div>
          </div>
          
          <a href="#" class="nav-item">
            <i class="fas fa-shopping-cart"></i> Compras
          </a>
          
          <a href="#" class="nav-item">
            <i class="fas fa-wrench"></i> Servicio
          </a>
          
          <a href="#" class="nav-item">
            <i class="fas fa-balance-scale"></i> Metrología
          </a>
        </div>
        
        <!-- Segunda fila de navegación -->
        <div class="nav-menu-row">
          <a href="#" class="nav-item">
            <i class="fas fa-file-alt"></i> Informes
          </a>
          
          <a href="#" class="nav-item">
            <i class="fas fa-laptop"></i> Sistemas
          </a>
          
          <a href="#" class="nav-item">
            <i class="fas fa-bullhorn"></i> Marketing
          </a>
          
          <a href="#" class="nav-item">
            <i class="fas fa-check-circle"></i> Calidad
          </a>
          
          <a href="#" class="nav-item">
            <i class="fas fa-users"></i> Clientes
          </a>
          
          <a href="#" class="nav-item">
            <i class="fas fa-cog"></i> Configuración
          </a>
        </div>
      </div>
      
      <div class="user-menu">
        <div class="notifications">
          <button class="notification-btn">
            <i class="far fa-bell"></i>
          </button>
          <button class="notification-btn">
            <i class="far fa-envelope"></i>
          </button>
        </div>
        
        <div class="user-profile">
          <div class="user-avatar">
            <img src="https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=100&h=100" alt="User profile">
          </div>
          <div class="user-info">
            <div class="user-name">Carlos Méndez</div>
            <div class="user-role">Administrador</div>
          </div>
        </div>
        
        <button class="mobile-menu-toggle" id="mobileMenuToggle">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>
  </nav>

  <!-- Contenido principal -->
  <main class="main-content" id="mainContent">
    <div class="container">
      <div class="dashboard-header">
        <h1 class="page-title">Solicitud de Material</h1>
        <button class="theme-toggle" id="themeToggle">
          <i class="fas fa-moon"></i>
        </button>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Nueva Solicitud</h2>
        </div>
        <div class="card-content">
          <form id="materialRequestForm" aria-label="Formulario de solicitud de material" role="form">
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label" for="folio">Folio</label>
                <input type="text" id="folio" class="form-control" readonly value="SOL-2024-003" aria-label="Folio de solicitud">
              </div>
              
              <div class="form-group">
                <label class="form-label" for="date">Fecha</label>
                <input type="date" id="date" class="form-control" value="2024-05-08" aria-label="Fecha de solicitud">
              </div>
            </div>
            
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label" for="company">Empresa que solicita:</label>
                <select id="company" class="form-select" aria-label="Empresa que solicita">
                  <option value="">Seleccionar empresa</option>
                  <option value="comintec-mexico">COMINTEC DE MÉXICO S.A. DE C.V.</option>
                  <option value="metrological">METROLOGICAL COMINTEC SERVICES S.C.</option>
                  <option value="comintec-guadalajara">TECNOLOGÍAS COMINTEC GUADALAJARA</option>
                  <option value="com-instrumentacion">COM INSTRUMENTACION Y TECNOLOGIA S.A. DE C.V.</option>
                </select>
              </div>
              
              <div class="form-group">
                <label class="form-label" for="requester">Solicitante</label>
                <input type="text" id="requester" class="form-control" placeholder="Nombre del solicitante" aria-label="Nombre del solicitante">
              </div>
            </div>
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label" for="quantity">Cantidad</label>
                <input type="text" id="quantity" class="form-control" placeholder="Ingresa un número entero" aria-label="Cantidad solicitada">
                <span id="quantityError" style="color: red; display: none;" role="alert" aria-live="assertive" data-i18n="material.quantityError">Por favor, ingresa un número entero válido.</span>
                <script>
                document.getElementById('quantity').addEventListener('input', function(e) {
                  const value = e.target.value;
                  const isValid = /^[1-9]\d*$/.test(value); // Solo números enteros positivos
                  const errorSpan = document.getElementById('quantityError');
                  if (!isValid && value !== '') {
                  errorSpan.style.display = 'inline';
                  e.target.style.borderColor = '#ef4444';
                  } else {
                  errorSpan.style.display = 'none';
                  e.target.style.borderColor = '';
                  }
                });
                </script>
              </div>
            </div>
              
              <div class="form-group">
                <label class="form-label" for="materialType">Tipo de material</label>
                <select id="materialType" class="form-select" aria-label="Tipo de material">
                  <option value="">Seleccionar tipo</option>
                  <option value="herramientas">Herramientas</option>
                  <option value="oficina">Material de oficina</option>
                  <option value="seguridad">Equipo de seguridad</option>
                  <option value="electrónica">Componentes electrónicos</option>
                  <option value="refacciones">Refacciones</option>
                </select>
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="description">Descripción</label>
              <textarea id="description" class="form-textarea" placeholder="Descripción detallada del material solicitado" aria-label="Descripción del material"></textarea>
            </div>
            
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label" for="model">Modelo (opcional)</label>
                <input type="text" id="model" class="form-control" placeholder="Modelo del material" aria-label="Modelo del material">
              </div>
              
              <div class="form-group">
                <label class="form-label" for="brand">Marca (opcional)</label>
                <input type="text" id="brand" class="form-control" placeholder="Marca del material" aria-label="Marca del material">
              </div>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="specifications">Especificaciones adicionales (opcional)</label>
              <textarea id="specifications" class="form-textarea" placeholder="Especificaciones técnicas adicionales" aria-label="Especificaciones adicionales"></textarea>
            </div>
            
            <div class="form-group">
              <label class="form-label" for="supplier">Proveedor sugerido (opcional)</label>
              <input type="text" id="supplier" class="form-control" placeholder="Proveedor sugerido" aria-label="Proveedor sugerido">
            </div>
            
            <div class="form-group">
              <label class="form-label" for="notes">Notas adicionales (opcional)</label>
              <textarea id="notes" class="form-textarea" placeholder="Notas o comentarios adicionales" aria-label="Notas adicionales"></textarea>
            </div>
          </form>
        </div>
        <div class="card-footer">
          <button type="submit" class="form-button" id="submitRequest" aria-label="Enviar solicitud" data-i18n="material.submit">Enviar solicitud</button>
          <button type="button" class="form-button form-button-secondary" style="margin-left: 10px;" id="cancelRequest" aria-label="Cancelar solicitud" data-i18n="material.cancel">Cancelar</button>
        </div>
      </div>
    </div>
  </main>
  <div id="summaryCard" style="display:none;"></div>
  <script src="js/main.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const submitBtn = document.getElementById('submitRequest');
      const cancelBtn = document.getElementById('cancelRequest');
      const form = document.getElementById('materialRequestForm');
      const summaryCard = document.getElementById('summaryCard');
      const mainContent = document.getElementById('mainContent');

      // Funcionalidad para el botón de cancelar
      cancelBtn.addEventListener('click', function() {
        window.location.href = 'main.html';
      });

      // Utilidades para obtener valores
      const getValue = id => document.getElementById(id)?.value || '';
      const getSelectText = id => {
        const el = document.getElementById(id);
        return el && el.options[el.selectedIndex] ? el.options[el.selectedIndex].text : '';
      };

      submitBtn.addEventListener('click', function(e) {
        e.preventDefault();

        // Validar campos requeridos
        const requiredFields = ['company', 'requester', 'quantity', 'materialType', 'description'];
        let isValid = true;

        requiredFields.forEach(field => {
          const element = document.getElementById(field);
          if (!element.value.trim()) {
            element.style.borderColor = '#ef4444';
            isValid = false;
          } else {
            element.style.borderColor = '';
          }
        });

        // Validación de cantidad como entero positivo
        const quantity = document.getElementById('quantity').value.trim();
        if (!/^[1-9]\d*$/.test(quantity)) {
          document.getElementById('quantity').style.borderColor = '#ef4444';
          isValid = false;
        }

        if (isValid) {
          // Oculta el main y muestra el resumen
          mainContent.style.display = 'none';
          summaryCard.innerHTML = `
            <div class="summary-modern">
              <div class="success-message">
                <i class="fas fa-check-circle"></i> Datos enviados correctamente
              </div>
              <h3>Resumen de la solicitud</h3>
              <div class="summary-list">
                <div><strong>Folio:</strong> ${getValue('folio')}</div>
                <div><strong>Fecha:</strong> ${getValue('date')}</div>
                <div><strong>Empresa que solicita:</strong> ${getSelectText('company')}</div>
                <div><strong>Solicitante:</strong> ${getValue('requester')}</div>
                <div><strong>Cantidad:</strong> ${getValue('quantity')}</div>
                <div><strong>Descripción:</strong> ${getValue('description')}</div>
                <div><strong>Modelo:</strong> ${getValue('model')}</div>
                <div><strong>Marca:</strong> ${getValue('brand')}</div>
                <div><strong>Especificaciones:</strong> ${getValue('specifications')}</div>
                <div><strong>Tipo de material:</strong> ${getSelectText('materialType')}</div>
                <div><strong>Proveedor sugerido:</strong> ${getValue('supplier')}</div>
                <div><strong>Notas:</strong> ${getValue('notes')}</div>
              </div>
              <button class="form-button" id="backToForm" style="margin-top:1.5rem;">Nueva solicitud</button>
            </div>
          `;
          summaryCard.style.display = 'block';

          // Botón para volver a nueva solicitud
          document.getElementById('backToForm').onclick = function() {
            form.reset();
            summaryCard.style.display = 'none';
            mainContent.style.display = '';
          };
        } else {
          alert('Por favor, complete todos los campos obligatorios correctamente');
        }
      });

      // Evento de cancelar
      cancelBtn.addEventListener('click', function() {
        if (confirm('¿Está seguro que desea cancelar? Los datos no guardados se perderán.')) {
          window.location.href = 'main.html';
        }
      });

      // Restaurar bordes al editar campos
      form.addEventListener('input', function(e) {
        if (e.target.tagName.toLowerCase() === 'input' ||
            e.target.tagName.toLowerCase() === 'textarea' ||
            e.target.tagName.toLowerCase() === 'select') {
          e.target.style.borderColor = '';
        }
      });
    });
  </script>
</body>
</html>